<h1>記事一覧</h1>

  <table class="table">

    <thead>
      <tr>
        <th>題材作品</th>
        <th>投稿記事</th>
        <th>投稿者</th>
        <th>コメント数</th>
        <th>ブックマーク数</th>
        <th>投稿日</th>
      </tr>
    </thead>

  <% reviews.each do |review| %>

    <tbody>
     <tr>
      <td>
        <% if review.user.is_deleted == false %>
           <%= image_tag review.get_image, size: "100x100" %><br>
           <%= review.book_name %>
        <% elsif review.user.is_deleted == true %>
           <%= image_tag asset_path("はてなマークのアイコン素材 12.png"), width: '85px' %>
        <% end %>
      </td>
      <td>
        <% if review.user.is_deleted == false %>
          <%= link_to review.review_title, users_review_path(review.id) %>
        <% elsif review.user.is_deleted == true %>
          <%= link_to users_review_path(review.id) do %>
            投稿者退会のため、非表示になりました。
          <% end %>
        <% end %>
      </td>
      <td>
        <% if review.user.is_deleted == false %>

            <% if user_signed_in? %>

              <%= link_to users_user_path(review.user.id) do %>
                <%= image_tag review.user.get_profile_image, width: '85px' %><br>
                <%= review.user.name %>
              <% end %>

            <% else %>

                <%= image_tag review.user.get_profile_image, width: '85px' %><br>
                <%= review.user.name %>

            <% end %>

        <% elsif review.user.is_deleted == true %>

                <%= image_tag asset_path("publicdomainq-0066061vap.jpg"), width: '85px' %><br>
                <%= review.user.name %>

        <% end %>

      </td>
      <td>
        <% if review.user.is_deleted == false %>
           <%= review.review_comments.count %>
        <% end %>
      </td>
      <td>
        <% if review.user.is_deleted == false %>

            <div class="m-2">♥<%= review.review_favorites.count %> いいね</div>

            <% if @user == current_user %>

            <div class="m-2">
              <%= link_to users_review_review_favorites_path(review, params: { review: { down: 3} }), method: :delete do %>
                自分のブックマークを外す
              <% end %>
            </div>

            <% else %>

            <% end %>

        <% end %>
      </td>
      <td><%= review.created_at.strftime('%Y/%m/%d') %></td>
     </tr>
    </tbody>

  <% end %>

  </table>